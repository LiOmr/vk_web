{% extends 'layouts/base.html' %}
{% load static %}

{% block content %}
    <div class="d-flex gap-3 align-items-center">
        <h1 class="title">Question</h1>
    </div>
    
    <div class="col-8">

        <article class="mt-3 mb-3 w-100 justify-content-between">
        <question class="card">
            <div class="row g-0">
                <div class="" style="width: 110px;">
                    <div class="border mb-3 rounded" style="height: 110px; width: 110px;">
                        <img
                            src="{{ question.author.profile.avatar.url }}"
                            class="rounded"
                            style="object-fit: cover; width: 100%; height: 100%;"
                            alt="..."
                        />
                    </div>
                    <div class ="item-with-buttons">
                        <div class="d-flex" style="width: 100px;">
                            <label class='rating' data-component="question" data-component-id="{{ question.id }}" style="text-align: center;">{{ question.rating }}</label>
                        </div>
                        <div class="d-flex justify-content-between" style="width: 100px;">
                            <button name="Like" type="button" class="mb-3 Like bi bi-arrow-up-short btn btn-sm btn-light fs-5 p-0" data-action="Like">
                                <img src="{% static "img/like.svg" %}" width="25" height="25" alt="arrow up" />
                            </button>
                            <button name="Dislike" type="button" class="mb-3 Dislike bi bi-arrow-down-short btn btn-sm btn-light fs-5 p-0" data-action="Dislike">
                                <img src="{% static "img/dislike.svg" %}" width="25" height="25" alt="arrow down" />
                            </button>
                        </div>
                    </div>
                </div>

                <div class="col">
                    <div class="card-body ms-3">
                        <h5 class="card-title" style="font-size:26px;">{{ question.title }}</h5>
                        <p class="card-text">
                            {{ question.content }}
                        </p>

                        <div class="row">
                            <div class="col">
                                <span>Tags:</span>
                                {% for tag in question.tags.all %}
                                <a href="{% url 'tag' tag %}">{{ tag.name }}</a>
                                {% endfor %}
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </question>
        </article>


        <div class="d-flex gap-3 align-items-center">
            <h1 class="title_answers">Answers</h1>
        </div>

        {% if not answers %}
        <div class="d-flex gap-3 align-items-center">
            <h3 class="title_answers">;( We don't have answers yet</h3>
        </div>
        {% endif %}
        
        {% for answer in answers %}
            {% include 'layouts/answer.html' %}
        {% endfor %}

        {% if answers %}
        {% include 'layouts/pagination.html' with page_obj=answers%}
        {% endif %}

        {% if request.user.is_authenticated %}
        <div class="container-fluid" >
            <form action="{% url 'question' question_id=question.id %}" method="post">
                {% csrf_token %}
                <textarea maxlength="200" class="w-100" style="height: 100px; resize: none;" name="content" placeholder="Write your answer" id="content" required></textarea>
                <button class="btn btn-outline-success mt-3 mb-3" type="submit">ANSWER!</button>
            </form>
        </div>
        {% endif %}

    </div>
    <!-- JS для прокрутки -->
    <script>
        // Прокрутка до нового ответа при загрузке страницы
        window.onload = function() {
            var answerId = window.location.hash.substr(1); // Получаем id ответа из якоря
            if (answerId) {
                var answerElement = document.getElementById(answerId);
                if (answerElement) {
                    answerElement.scrollIntoView({ behavior: 'smooth' });
                }
            }
        };
    </script>
{% endblock %}
